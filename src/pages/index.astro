---
import Layout from '../layouts/Layout.astro';
import { Image } from 'astro:assets';
import allWines from '../assets/all-wines.png';
import allWinesMobile from '../assets/all-wines-mobile.png';
import glass from '../assets/glass.svg';
import leaf from '../assets/leaf.svg';
import hexagon from '../assets/hexagon.svg';
import { MuxPlayer } from '@mux/mux-player-astro';
import bottleAlb from '../assets/bottle-alb-demisec.png';
import bottleRosu from '../assets/bottle-rosu-sec.png';
import bottleRoze from '../assets/bottle-roze-demisec.png';
import bottleSpumant from '../assets/bottle-spumant-demisec.png';
---

<Layout title="Nextaz">
  <div class="flex min-h-screen flex-col items-center">
    <picture class="inset-0 h-full w-full">
      <source media="(min-width: 1024px)" srcset={allWines.src} />
      <Image src={allWinesMobile} class="w-full object-cover" loading="eager" alt="All Wines" />
    </picture>
    <div class="flex w-full flex-col items-center py-18 lg:flex-row lg:justify-evenly lg:py-40">
      <div class="flex">
        <div
          class="h-[36vw] max-h-175 min-h-88 w-[25vw] max-w-105 min-w-53 lg:min-h-116 lg:min-w-70"
          style="clip-path: polygon(0 0, 100% 50%, 0 100%);"
        >
          <MuxPlayer
            playbackId="HjiJrWEuFT95bsSTMhW8NDP8Zad4gszfcYcUHOUSLzk"
            metadata={{ video_title: 'wine bubbles' }}
            streamType="on-demand"
            autoplay
            muted
            loop
            nohotkeys
            class="h-full w-full"
            style={{
              '--controls': 'none',
              '--media-object-fit': 'cover',
              '--media-object-position': 'center',
            }}
          />
        </div>
        <div
          class="h-[36vw] max-h-175 min-h-88 w-[9vw] max-w-45 min-w-23 bg-black lg:min-h-116 lg:min-w-31"
        >
        </div>
      </div>
      <div class="mx-[2vw] mt-25 flex h-full min-h-140 w-95 flex-col justify-between lg:mt-0">
        {
          [
            {
              icon: leaf,
              text: 'Vinuri moderne create pentru un stil de viață tânăr și relaxat.',
            },
            {
              icon: hexagon,
              text: 'Soiuri locale reinterpretate într-un profil fresh și ușor de savurat.',
            },
            {
              icon: glass,
              text: 'Perfecte pentru terase, seri cu prietenii și momente fără complicații.',
            },
          ].map(({ icon, text }) => (
            <div class="flex flex-col items-center lg:items-start">
              <Image src={icon} alt="Wine Icon" />
              <p class="mt-4 text-center text-xl/loose lg:text-left">{text}</p>
            </div>
          ))
        }
      </div>
    </div>
    <h2 class="mb-30 text-[3.25rem] font-bold">Gama Nextaz</h2>
    <div class="wine-cells-container relative flex w-full flex-row flex-wrap">
      {
        [
          {
            id: 'roze',
            image: bottleRoze,
            title: 'Nextaz Rosé',
            description:
              'Aromă delicată de trandafir și fructe roșii, un rosé elegant, iubit pentru prospețime și culoare.',
            aromatic: ['Trandafir', 'Busuioc', 'Cireșe', 'Căpșuni', 'Grapefruit', 'Măr glazurat'],
            organoleptic: [
              'Busuioacă de Bohotin demisec, intens aromatică',
              'Culoare rosé somon / cireașă, strălucitoare',
              'Textură delicată, fină, crocantă',
              'Aciditate ridicată, bine integrată',
              'Durată de viață: 3-5 ani',
              'După deschidere: până la 1 săptămână la frigider',
              'Temperatura de servire: 8-10°C',
            ],
            culinary: [
              'Aperitive: bruschete cu roșii și busuioc, spring rolls, jamón, chorizo ',
              'Preparate principale: mâncăruri asiatice condimentate sau picante, fructe de mare, paella, piept de rață cu sos de smochine, aripioare de pui picante ',
              'Carne & pește: porc cu sosuri dulci sau caramelizate, păstrăv, crap ',
              'Legume & garnituri: cartof dulce, dovleac copt cu scorțișoară, alte legume cu dulceață naturală ',
              'Alături de gustări reci: platouri cu fructe de vară, măsline marinate și salate fresh cu dressing ușor.',
            ],
          },
          {
            id: 'alb',
            image: bottleAlb,
            title: 'Nextaz Alb',
            description:
              'Un vin alb răcoritor, cu note fructate și citrice, perfect pentru mese lejere sau ieșiri de weekend.',
            aromatic: ['Lămâie', 'Grapefruit', 'Mere verzi', 'Flori albe', 'Mentă'],
            organoleptic: [
              'Vin alb demisec, fresh și echilibrat',
              'Culoare galben-pai strălucitoare',
              'Textură ușoară, revigorantă',
              'Aciditate vie, plăcută',
              'Durată de viață: 2-4 ani',
              'Perfect pentru vară și ocazii relaxante',
              'Temperatura de servire: 8-10°C',
            ],
            culinary: [
              'Aperitive: salate proaspete, brânzeturi fresh',
              'Preparate principale: pește alb, fructe de mare',
              'Paste cu sos alb sau legume',
              'Salate: Caesar, salate verzi cu dressing ușor',
              'Deserturi: tarte cu lămâie, sorbet',
            ],
          },
          {
            id: 'rosu',
            image: bottleRosu,
            title: 'Nextaz Roșu',
            description:
              'Fetească Neagră matură, catifelată, cu note de ciocolată neagră și prune uscate.',
            aromatic: ['Ciocolată neagră', 'Prune uscate', 'Vișine', 'Condimente', 'Vanilie'],
            organoleptic: [
              'Vin roșu sec, corpulent și elegant',
              'Culoare roșu-rubinu intens',
              'Textură catifelată, tanine moi',
              'Aciditate echilibrată',
              'Durată de viață: 5-8 ani',
              'Perfect pentru carne roșie și preparate intense',
              'Temperatura de servire: 16-18°C',
            ],
            culinary: [
              'Aperitive: brânzeturi mature, salamuri',
              'Preparate principale: friptură, miel, vânat',
              'Paste cu sos de roșii, ragu',
              'Legume la grătar, ciuperci',
              'Deserturi: ciocolată neagră',
            ],
          },
          {
            id: 'spumant',
            image: bottleSpumant,
            title: 'Nextaz Spumant',
            description:
              'Un spumant vibrant, cu note de măr verde și citrice, potrivit pentru orice moment spontan.',
            aromatic: ['Măr verde', 'Citrice', 'Pâine prăjită', 'Flori albe', 'Miere'],
            organoleptic: [
              'Spumant demisec, elegant și persistent',
              'Culoare galben-pai cu reflexe verzi',
              'Perlaj fin și persistent',
              'Aciditate vie, echilibrată',
              'Durată de viață: 2-3 ani',
              'Perfect pentru celebrări și aperitive',
              'Temperatura de servire: 6-8°C',
            ],
            culinary: [
              'Aperitive: caviar, somon afumat, oysters',
              'Preparate: fructe de mare, sushi',
              'Salate: salate sofisticate cu dressing ușor',
              'Deserturi: fructe proaspete, prăjituri ușoare',
            ],
          },
        ].map(({ id, image, title, description, aromatic, organoleptic, culinary }) => (
          <div
            data-wine-id={id}
            class="wine-cell group bg-gray-light hover:bg-gray-lighter flex aspect-auto w-full cursor-pointer overflow-hidden border border-white transition-all duration-300 lg:aspect-square lg:w-1/2"
            aria-expanded="false"
          >
            <div class="flex h-full w-full flex-col px-8 py-12">
              <div class="flex h-full flex-col items-center justify-between group-aria-expanded:h-90 group-aria-expanded:w-[30%]">
                <Image
                  src={image}
                  alt={title}
                  class="h-auto w-70 transition-transform duration-300 group-hover:scale-115 lg:w-[20vw]"
                  loading="eager"
                />
                <h3 class="mb-2 text-center text-3xl font-bold">{title}</h3>
                <p class="mb-2 max-w-sm text-center text-xl">{description}</p>
                <button class="text-gray text-base underline transition-all duration-300 group-hover:scale-115 group-hover:text-black group-aria-expanded:hidden">
                  Vezi detalii
                </button>
                <a
                  href="/shop"
                  class="btn-add-to-cart hidden text-lg group-aria-expanded:block lg:text-2xl"
                >
                  Comandă
                </a>
              </div>
            </div>
          </div>
        ))
      }
    </div>
    <h1
      class="animate-pulse bg-linear-to-r from-red-500 via-rose-400 to-red-600 bg-clip-text text-7xl font-bold text-transparent drop-shadow-[0_0_15px_rgba(239,68,68,0.5)]"
    >
      NEXTAZ
    </h1>
    <div
      id="command-modal"
      class="absolute top-75 flex w-80 translate-y-80 flex-col items-center border border-white/30 bg-white/1 px-7 py-10 opacity-0 shadow-2xl backdrop-blur-sm transition-all duration-1000 lg:w-160 lg:px-13 lg:py-16"
    >
      <h2 class="mb-4 text-center text-3xl leading-8 font-bold lg:text-[3.25rem] lg:leading-12">
        Pentru momentele<br />ce vin.
      </h2>
      <p class="mb-6 text-center text-lg lg:text-2xl">
        Eleganță, și autenticitate, create pentru momentele în care vrei să fie bine.
      </p>
      <a href="/shop" class="btn-add-to-cart text-lg lg:text-2xl"> Comandă </a>
    </div>
  </div>
</Layout>

<script>
  import { set } from 'astro:schema';

  function revealModal() {
    const modal = document.getElementById('command-modal');
    if (!modal) return;
    setTimeout(() => {
      modal.classList.remove('opacity-0', 'translate-y-80');
      modal.classList.add('opacity-100', 'translate-y-0');
    }, 1000);
  }

  function initWineCells() {
    const container = document.querySelector('.wine-cells-container');
    if (!container) return;

    const cells = container.querySelectorAll('.wine-cell');
    let expandedCell: Element | null = null;

    cells.forEach((cell) => {
      cell.addEventListener('click', (_) => {
        const otherCells = Array.from(cells).filter((c) => c !== cell) as HTMLElement[];

        if (expandedCell === cell) {
          collapseCell(cell, otherCells);
          expandedCell = null;
          return;
        }

        // Expand this cell
        expandCell(cell as HTMLElement, otherCells);
        expandedCell = cell;

        setTimeout(() => {
          container.scrollIntoView({
            behavior: 'smooth',
            block: 'start',
          });
        });
      });
    });

    function expandCell(cell: HTMLElement, otherCells: HTMLElement[]) {
      // if (simpleContent) simpleContent.style.display = 'none';
      // if (modalContent) modalContent.classList.remove('hidden');
      cell.setAttribute('aria-expanded', 'true');

      if (window.innerWidth < 1024) {
        // cell.classList.remove('aspect-square');
        // cell.classList.add('h-auto');
      } else {
        cell.classList.remove('lg:w-1/2');
      }

      requestAnimationFrame(() => {
        otherCells.forEach((otherCell) => {
          otherCell.style.opacity = '0';
          otherCell.style.width = '0%';
          otherCell.style.height = '0%';
        });
      });
    }

    function collapseCell(cell: Element, otherCells: HTMLElement[]) {
      if (window.innerWidth < 1024) {
        // cell.classList.add('aspect-square');
        // cell.classList.remove('h-auto');
      } else {
        cell.classList.add('lg:w-1/2');
      }

      otherCells.forEach((otherCell) => {
        otherCell.style.opacity = '1';
        otherCell.style.removeProperty('width');
        otherCell.style.removeProperty('height');
      });

      setTimeout(() => {
        cell.setAttribute('aria-expanded', 'false');
      }, 300);
    }
  }

  document.addEventListener('astro:page-load', () => {
    revealModal();
    initWineCells();
  });
</script>
